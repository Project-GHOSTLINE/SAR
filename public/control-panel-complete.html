<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SAR Control Panel - Toutes les Routes</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'SF Mono', 'Consolas', 'Monaco', monospace;
      background: #000000;
      color: #00ff00;
      overflow-x: hidden;
    }

    .control-panel {
      display: grid;
      grid-template-rows: 60px 1fr;
      height: 100vh;
    }

    /* Header */
    .header {
      background: linear-gradient(180deg, #1a1a1a 0%, #0d0d0d 100%);
      border-bottom: 2px solid #00ff00;
      padding: 0 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 20px rgba(0, 255, 0, 0.3);
    }

    .header h1 {
      font-size: 20px;
      color: #00ff00;
      text-shadow: 0 0 10px #00ff00;
      letter-spacing: 2px;
    }

    .header-stats {
      display: flex;
      gap: 30px;
      font-size: 12px;
    }

    .stat {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .stat-value {
      font-weight: bold;
      color: #00ff00;
      font-size: 16px;
    }

    /* Main Layout */
    .main-grid {
      display: grid;
      grid-template-columns: 280px 1fr;
      height: calc(100vh - 60px);
    }

    /* Sidebar */
    .sidebar {
      background: #0a0a0a;
      border-right: 2px solid #00ff00;
      overflow-y: auto;
      padding: 20px 10px;
    }

    .menu-category {
      margin-bottom: 20px;
    }

    .category-header {
      font-size: 12px;
      color: #00ff00;
      background: rgba(0, 255, 0, 0.1);
      padding: 8px 12px;
      border-left: 3px solid #00ff00;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .category-header:hover {
      background: rgba(0, 255, 0, 0.2);
    }

    .category-count {
      background: #00ff00;
      color: #000;
      padding: 2px 6px;
      border-radius: 8px;
      font-size: 10px;
      font-weight: bold;
    }

    .category-routes {
      padding-left: 8px;
    }

    .route-item {
      padding: 6px 10px;
      margin: 3px 0;
      background: rgba(0, 255, 0, 0.03);
      border-left: 2px solid transparent;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 10px;
      color: #888;
    }

    .route-item:hover {
      background: rgba(0, 255, 0, 0.1);
      border-left-color: #00ff00;
      padding-left: 14px;
      color: #00ff00;
    }

    .route-item.active {
      background: rgba(0, 255, 0, 0.2);
      border-left: 3px solid #00ff00;
      color: #00ff00;
    }

    .route-method {
      display: inline-block;
      padding: 1px 4px;
      border-radius: 2px;
      font-size: 9px;
      font-weight: bold;
      margin-right: 4px;
    }

    .route-method.GET { background: rgba(0, 255, 0, 0.3); color: #00ff00; }
    .route-method.POST { background: rgba(0, 150, 255, 0.3); color: #0096ff; }
    .route-method.PUT { background: rgba(255, 165, 0, 0.3); color: #ffa500; }
    .route-method.DELETE { background: rgba(255, 0, 0, 0.3); color: #ff0000; }

    /* Main View */
    .main-view {
      background: #000000;
      overflow-y: auto;
      padding: 30px;
    }

    .view-header {
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #00ff00;
    }

    .view-title {
      font-size: 24px;
      color: #00ff00;
      text-shadow: 0 0 10px #00ff00;
      margin-bottom: 10px;
    }

    .view-subtitle {
      color: #666;
      font-size: 12px;
    }

    .routes-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 15px;
    }

    .route-card {
      background: linear-gradient(135deg, #0d0d0d 0%, #1a1a1a 100%);
      border: 2px solid #333;
      border-left: 4px solid #333;
      border-radius: 8px;
      padding: 15px;
      transition: all 0.3s ease;
    }

    .route-card.status-success {
      border-left-color: #00ff00;
    }

    .route-card.status-error {
      border-left-color: #ff0000;
    }

    .route-card.status-warning {
      border-left-color: #ffff00;
    }

    .route-card:hover {
      border-color: #00ff00;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
      transform: translateY(-3px);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }

    .card-method {
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: bold;
    }

    .card-path {
      font-size: 12px;
      color: #00ff00;
      font-weight: bold;
      margin-bottom: 8px;
      word-break: break-all;
    }

    .card-description {
      font-size: 10px;
      color: #666;
      line-height: 1.4;
      margin-bottom: 12px;
    }

    .card-stats {
      display: flex;
      justify-content: space-between;
      padding-top: 10px;
      border-top: 1px solid #333;
      font-size: 10px;
    }

    .status-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 10px;
    }

    .status-badge.success {
      background: rgba(0, 255, 0, 0.2);
      color: #00ff00;
      border: 1px solid #00ff00;
    }

    .status-badge.error {
      background: rgba(255, 0, 0, 0.2);
      color: #ff0000;
      border: 1px solid #ff0000;
    }

    .status-badge.untested {
      background: rgba(136, 136, 136, 0.2);
      color: #888;
      border: 1px solid #888;
    }

    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    .status-badge.success .status-dot {
      background: #00ff00;
      box-shadow: 0 0 8px #00ff00;
    }

    .status-badge.error .status-dot {
      background: #ff0000;
      box-shadow: 0 0 8px #ff0000;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    .card-metrics {
      display: flex;
      gap: 10px;
      font-size: 10px;
      color: #666;
    }

    .metric-item {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }

    .metric-value {
      font-size: 12px;
      color: #00ff00;
      font-weight: bold;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #0a0a0a;
    }

    ::-webkit-scrollbar-thumb {
      background: #00ff00;
      border-radius: 4px;
    }

    /* Search */
    .search-box {
      margin-bottom: 20px;
    }

    .search-input {
      width: 100%;
      padding: 12px;
      background: rgba(0, 255, 0, 0.05);
      border: 2px solid #00ff00;
      border-radius: 6px;
      color: #00ff00;
      font-family: inherit;
      font-size: 12px;
    }

    .search-input::placeholder {
      color: #666;
    }

    .search-input:focus {
      outline: none;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
    }
  </style>
</head>
<body>
  <div class="control-panel">
    <!-- Header -->
    <div class="header">
      <h1>üö¶ SAR CONTROL PANEL - TOUTES LES ROUTES</h1>
      <div class="header-stats">
        <div class="stat">
          <span>Routes:</span>
          <span class="stat-value" id="totalRoutes">0</span>
        </div>
        <div class="stat">
          <span>Cat√©gories:</span>
          <span class="stat-value" id="totalCategories">0</span>
        </div>
        <div class="stat">
          <span>Online:</span>
          <span class="stat-value" id="onlineCount">0</span>
        </div>
        <div class="stat">
          <span>Errors:</span>
          <span class="stat-value" id="errorCount" style="color: #ff0000;">0</span>
        </div>
      </div>
    </div>

    <!-- Main Grid -->
    <div class="main-grid">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="search-box">
          <input
            type="text"
            class="search-input"
            placeholder="üîç Rechercher une route..."
            id="searchInput"
            onkeyup="filterRoutes()"
          >
        </div>
        <div id="menuCategories">
          <!-- Categories will be injected here -->
        </div>
      </div>

      <!-- Main View -->
      <div class="main-view">
        <div class="view-header">
          <div class="view-title" id="viewTitle">TOUTES LES ROUTES</div>
          <div class="view-subtitle" id="viewSubtitle">69 routes API d√©tect√©es dans le syst√®me</div>
        </div>
        <div class="routes-grid" id="routesGrid">
          <!-- Routes will be injected here -->
        </div>
      </div>
    </div>
  </div>

  <script>
    const SUPABASE_URL = 'https://dllyzfuqjzuhvshrlmuq.supabase.co'
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsbHl6ZnVxanp1aHZzaHJsbXVxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5OTU5ODEsImV4cCI6MjA4MTU3MTk4MX0.xskVblRlKdbTST1Mdgz76oR7N2rDq8ZOUgaN-f_TTM4'

    // TOUTES LES ROUTES (69 routes compl√®tes)
    const ROUTES = [
      // ADMIN (18 routes)
      { category: 'Admin', method: 'POST', path: '/api/admin/login', description: 'Authentification administrateur' },
      { category: 'Admin', method: 'POST', path: '/api/admin/logout', description: 'D√©connexion administrateur' },
      { category: 'Admin', method: 'GET', path: '/api/admin/messages', description: 'Liste des messages clients' },
      { category: 'Admin', method: 'POST', path: '/api/admin/messages/assign', description: 'Assigner un message √† un agent' },
      { category: 'Admin', method: 'GET', path: '/api/admin/client-analysis', description: 'Analyse compl√®te d\'un client' },
      { category: 'Admin', method: 'GET', path: '/api/admin/analytics', description: 'Analytics g√©n√©rales' },
      { category: 'Admin', method: 'GET', path: '/api/admin/analytics/dashboard', description: 'Dashboard analytics principal' },
      { category: 'Admin', method: 'GET', path: '/api/admin/support/tickets', description: 'Liste des tickets de support' },
      { category: 'Admin', method: 'POST', path: '/api/admin/support/tickets', description: 'Cr√©er un nouveau ticket' },
      { category: 'Admin', method: 'GET', path: '/api/admin/support/tickets/[id]', description: 'D√©tails d\'un ticket sp√©cifique' },
      { category: 'Admin', method: 'PUT', path: '/api/admin/support/tickets/[id]', description: 'Mettre √† jour un ticket' },
      { category: 'Admin', method: 'GET', path: '/api/admin/support/messages', description: 'Messages de support' },
      { category: 'Admin', method: 'GET', path: '/api/admin/support/stats', description: 'Statistiques de support' },
      { category: 'Admin', method: 'GET', path: '/api/admin/database/explore', description: 'Explorateur de base de donn√©es' },
      { category: 'Admin', method: 'GET', path: '/api/admin/metrics/inspect', description: 'Inspection des m√©triques' },
      { category: 'Admin', method: 'GET', path: '/api/admin/downloads/stats', description: 'Statistiques de t√©l√©chargements' },
      { category: 'Admin', method: 'POST', path: '/api/admin/send', description: 'Envoi de messages admin' },
      { category: 'Admin', method: 'GET', path: '/api/admin/vopay-debug', description: 'Debug VoPay' },

      // VOPAY (4 routes)
      { category: 'VoPay', method: 'GET', path: '/api/admin/vopay', description: 'Donn√©es VoPay g√©n√©rales' },
      { category: 'Admin', method: 'GET', path: '/api/admin/vopay/transactions', description: 'Transactions VoPay' },
      { category: 'Admin', method: 'GET', path: '/api/admin/vopay/real-transactions', description: 'Transactions VoPay r√©elles (API externe)' },
      { category: 'VoPay', method: 'GET', path: '/api/vopay/stats', description: 'Statistiques VoPay publiques' },
      { category: 'VoPay', method: 'GET', path: '/api/vopay/stats/[clientId]', description: 'Stats VoPay par client' },

      // WEBHOOKS (5 routes)
      { category: 'Webhooks', method: 'GET', path: '/api/admin/webhooks/list', description: 'Liste de tous les webhooks' },
      { category: 'Webhooks', method: 'GET', path: '/api/admin/webhooks/stats', description: 'Statistiques des webhooks' },
      { category: 'Webhooks', method: 'POST', path: '/api/admin/webhooks/send-alert', description: 'Envoyer une alerte webhook' },
      { category: 'Webhooks', method: 'GET', path: '/api/admin/webhooks/debug', description: 'Debug des webhooks' },
      { category: 'Webhooks', method: 'POST', path: '/api/webhooks/vopay', description: 'Webhook VoPay (callback externe)' },

      // SENTINEL SYSTEM (8 routes)
      { category: 'Sentinel', method: 'POST', path: '/api/sentinel/execute-command', description: 'Ex√©cuter une commande Sentinel' },
      { category: 'Sentinel', method: 'GET', path: '/api/sentinel/network-monitor', description: 'Monitoring r√©seau Sentinel' },
      { category: 'Sentinel', method: 'POST', path: '/api/sentinel/scan-project', description: 'Scanner le projet pour menaces' },
      { category: 'Sentinel', method: 'POST', path: '/api/sentinel/scoring', description: 'Calcul du score ML' },
      { category: 'Sentinel', method: 'POST', path: '/api/sentinel/execute', description: 'Ex√©cution de mission Sentinel' },
      { category: 'Sentinel', method: 'GET', path: '/api/sentinel/fleet', description: '√âtat de la flotte Sentinel' },
      { category: 'Sentinel', method: 'POST', path: '/api/sentinel/orchestrator', description: 'Orchestrateur Sentinel' },
      { category: 'Sentinel', method: 'POST', path: '/api/cortex/sync-miro', description: 'Synchronisation Cortex avec Miro' },

      // OSINT (7 routes)
      { category: 'OSINT', method: 'POST', path: '/api/osint/scan', description: 'Scan OSINT standard (credit check)' },
      { category: 'OSINT', method: 'POST', path: '/api/osint/advanced', description: 'Scan OSINT avanc√©' },
      { category: 'OSINT', method: 'POST', path: '/api/osint/network-scan', description: 'Scan r√©seau OSINT' },
      { category: 'OSINT', method: 'POST', path: '/api/osint/lab-scan', description: 'Scan laboratoire OSINT' },
      { category: 'OSINT', method: 'GET', path: '/api/osint/vulnerabilities', description: 'Liste des vuln√©rabilit√©s d√©tect√©es' },
      { category: 'OSINT', method: 'POST', path: '/api/osint/exploit-chains', description: 'Cha√Ænes d\'exploitation' },
      { category: 'OSINT', method: 'GET', path: '/api/osint/bypass-tests', description: 'Tests de bypass s√©curit√©' },

      // MEMORY SYSTEM (5 routes)
      { category: 'Memory', method: 'POST', path: '/api/memory/store', description: 'Stocker du contexte en m√©moire' },
      { category: 'Memory', method: 'GET', path: '/api/memory/recall', description: 'Rappeler le contexte stock√©' },
      { category: 'Memory', method: 'POST', path: '/api/memory/session', description: 'Gestion de session m√©moire' },
      { category: 'Memory', method: 'GET', path: '/api/memory/context', description: 'R√©cup√©rer le contexte actuel' },
      { category: 'Memory', method: 'POST', path: '/api/memory/doc-read', description: 'Lecture de documents en m√©moire' },

      // ACTIVITY (3 routes)
      { category: 'Activity', method: 'POST', path: '/api/activity/log', description: 'Logger une activit√©' },
      { category: 'Activity', method: 'GET', path: '/api/activity/stats', description: 'Statistiques d\'activit√©' },
      { category: 'Activity', method: 'GET', path: '/api/activity/recent', description: 'Activit√©s r√©centes' },

      // NETWORK (3 routes)
      { category: 'Network', method: 'GET', path: '/api/network/trace', description: 'Trace r√©seau (traceroute)' },
      { category: 'Network', method: 'POST', path: '/api/network/active-recon', description: 'Reconnaissance active' },
      { category: 'Network', method: 'GET', path: '/api/network/packet-capture', description: 'Capture de paquets r√©seau' },

      // APPLICATIONS (3 routes)
      { category: 'Applications', method: 'POST', path: '/api/applications/submit', description: 'Soumettre une demande de pr√™t' },
      { category: 'Applications', method: 'POST', path: '/api/device/deep-inspector', description: 'Inspection profonde d\'appareil (OCR + Face)' },
      { category: 'Applications', method: 'GET', path: '/api/anonymity/check', description: 'V√©rification d\'anonymat' },

      // AUDIT (2 routes)
      { category: 'Audit', method: 'GET', path: '/api/audit/[clientId]', description: 'Audit d\'un client sp√©cifique' },
      { category: 'Audit', method: 'GET', path: '/api/audit/stats', description: 'Statistiques d\'audit' },

      // DOWNLOADS (2 routes)
      { category: 'Downloads', method: 'POST', path: '/api/download/track', description: 'Tracker un t√©l√©chargement' },
      { category: 'Downloads', method: 'GET', path: '/api/download/[filename]', description: 'T√©l√©charger un fichier' },

      // ROUTES SYSTEM (2 routes)
      { category: 'System', method: 'POST', path: '/api/routes/expand', description: 'Expansion de routes' },
      { category: 'System', method: 'GET', path: '/api/routes/discover', description: 'D√©couverte automatique de routes' },

      // CONTACT (2 routes)
      { category: 'Contact', method: 'POST', path: '/api/contact', description: 'Formulaire de contact' },
      { category: 'Contact', method: 'POST', path: '/api/contact-analyse', description: 'Demande d\'analyse via contact' },

      // SECURITY (2 routes)
      { category: 'Security', method: 'GET', path: '/api/fingerprint/deep-scan', description: 'Scan d\'empreinte profond' },
      { category: 'Security', method: 'GET', path: '/api/seo/exploit-secrets', description: 'Exploitation de secrets SEO' },

      // METRICS & DIAGNOSTICS (2 routes)
      { category: 'System', method: 'GET', path: '/api/metrics/all', description: 'Toutes les m√©triques syst√®me' },
      { category: 'System', method: 'GET', path: '/api/performance-diagnostic', description: 'Diagnostic de performance' },

      // TEST (2 routes)
      { category: 'Test', method: 'GET', path: '/api/test/demo', description: 'Route de test d√©mo' },
      { category: 'Test', method: 'POST', path: '/api/test-tool', description: 'Outil de test' }
    ]

    let performanceData = {}
    let currentFilter = null

    // Fetch performance data from Supabase
    async function fetchPerformanceData() {
      try {
        const response = await fetch(`${SUPABASE_URL}/rest/v1/vw_route_performance?select=*`, {
          headers: {
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
          }
        })

        if (response.ok) {
          const data = await response.json()
          performanceData = {}
          data.forEach(route => {
            performanceData[route.route_path] = route
          })
        }
      } catch (error) {
        console.error('Error fetching performance data:', error)
      }
    }

    // Render categories in sidebar
    function renderCategories() {
      const categories = {}
      ROUTES.forEach(route => {
        if (!categories[route.category]) {
          categories[route.category] = []
        }
        categories[route.category].push(route)
      })

      const menuCategories = document.getElementById('menuCategories')
      menuCategories.innerHTML = ''

      // Add "All Routes" option
      const allHeader = document.createElement('div')
      allHeader.className = 'category-header'
      allHeader.onclick = () => filterByCategory(null)
      allHeader.innerHTML = `
        <span>üåê TOUTES LES ROUTES</span>
        <span class="category-count">${ROUTES.length}</span>
      `
      menuCategories.appendChild(allHeader)

      // Add each category
      Object.keys(categories).sort().forEach(category => {
        const routes = categories[category]

        const categoryDiv = document.createElement('div')
        categoryDiv.className = 'menu-category'

        const header = document.createElement('div')
        header.className = 'category-header'
        header.onclick = () => filterByCategory(category)
        header.innerHTML = `
          <span>${category}</span>
          <span class="category-count">${routes.length}</span>
        `

        const routesDiv = document.createElement('div')
        routesDiv.className = 'category-routes'
        routesDiv.style.display = 'none'

        routes.forEach(route => {
          const routeItem = document.createElement('div')
          routeItem.className = 'route-item'
          routeItem.onclick = (e) => {
            e.stopPropagation()
            filterByCategory(category)
            document.getElementById('searchInput').value = route.path
            filterRoutes()
          }
          routeItem.innerHTML = `
            <span class="route-method ${route.method}">${route.method}</span>
            ${route.path.split('/').pop()}
          `
          routesDiv.appendChild(routeItem)
        })

        header.onclick = () => {
          routesDiv.style.display = routesDiv.style.display === 'none' ? 'block' : 'none'
          filterByCategory(category)
        }

        categoryDiv.appendChild(header)
        categoryDiv.appendChild(routesDiv)
        menuCategories.appendChild(categoryDiv)
      })

      document.getElementById('totalCategories').textContent = Object.keys(categories).length
    }

    // Filter by category
    function filterByCategory(category) {
      currentFilter = category

      // Update active state
      document.querySelectorAll('.category-header').forEach(el => {
        if ((category === null && el.textContent.includes('TOUTES')) ||
            (category && el.textContent.includes(category))) {
          el.style.background = 'rgba(0, 255, 0, 0.3)'
        } else {
          el.style.background = 'rgba(0, 255, 0, 0.1)'
        }
      })

      const title = category ? category.toUpperCase() : 'TOUTES LES ROUTES'
      const count = category ? ROUTES.filter(r => r.category === category).length : ROUTES.length

      document.getElementById('viewTitle').textContent = title
      document.getElementById('viewSubtitle').textContent = `${count} routes dans cette cat√©gorie`

      renderRoutes()
    }

    // Filter routes by search
    function filterRoutes() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase()
      renderRoutes(searchTerm)
    }

    // Render routes
    function renderRoutes(searchTerm = '') {
      const grid = document.getElementById('routesGrid')
      grid.innerHTML = ''

      let filteredRoutes = ROUTES
      if (currentFilter) {
        filteredRoutes = filteredRoutes.filter(r => r.category === currentFilter)
      }
      if (searchTerm) {
        filteredRoutes = filteredRoutes.filter(r =>
          r.path.toLowerCase().includes(searchTerm) ||
          r.description.toLowerCase().includes(searchTerm)
        )
      }

      let onlineCount = 0
      let errorCount = 0

      filteredRoutes.forEach(route => {
        const perf = performanceData[route.path]

        let status = 'untested'
        let statusText = 'Non Test√©'
        let metrics = ''

        if (perf) {
          const avgTime = parseFloat(perf.avg_response_time_ms)
          const errorRate = parseFloat(perf.error_rate)

          if (errorRate > 0) {
            status = 'error'
            statusText = `${perf.error_count} Erreurs`
            errorCount++
          } else {
            status = 'success'
            statusText = 'OK'
            onlineCount++
          }

          metrics = `
            <div class="card-metrics">
              <div class="metric-item">
                <div class="metric-value">${avgTime.toFixed(0)}ms</div>
                <div>Latence</div>
              </div>
              <div class="metric-item">
                <div class="metric-value">${perf.total_requests}</div>
                <div>Requ√™tes</div>
              </div>
            </div>
          `
        }

        const card = document.createElement('div')
        card.className = `route-card status-${status}`
        card.innerHTML = `
          <div class="card-header">
            <div class="card-method ${route.method}">${route.method}</div>
          </div>
          <div class="card-path">${route.path}</div>
          <div class="card-description">${route.description}</div>
          <div class="card-stats">
            <div class="status-badge ${status}">
              <div class="status-dot"></div>
              <span>${statusText}</span>
            </div>
            ${metrics}
          </div>
        `

        grid.appendChild(card)
      })

      // Update header stats
      document.getElementById('totalRoutes').textContent = ROUTES.length
      document.getElementById('onlineCount').textContent = onlineCount
      document.getElementById('errorCount').textContent = errorCount
    }

    // Initialize
    async function init() {
      await fetchPerformanceData()
      renderCategories()
      renderRoutes()

      // Auto-refresh every 10 seconds
      setInterval(async () => {
        await fetchPerformanceData()
        renderRoutes()
      }, 10000)
    }

    window.addEventListener('load', init)
  </script>
</body>
</html>
