<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SAR - Plan d'Architecture Technique</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700;800&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg: #0f0f17;
      --bg-card: #1a1a24;
      --bg-hover: #232331;
      --border: #2d2d3d;
      --text: #e4e4e7;
      --text-dim: #a1a1aa;
      --accent: #3b82f6;
      --success: #10b981;
      --error: #ef4444;
      --warning: #f59e0b;
      --purple: #a855f7;
      --cyan: #06b6d4;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden;
    }

    .container {
      max-width: 1800px;
      margin: 0 auto;
      padding: 30px;
    }

    .header {
      margin-bottom: 40px;
      text-align: center;
    }

    .header h1 {
      font-size: 36px;
      font-weight: 800;
      margin-bottom: 10px;
      background: linear-gradient(90deg, var(--cyan), var(--purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .header p {
      color: var(--text-dim);
      font-size: 16px;
    }

    /* Architecture layers */
    .layer {
      margin-bottom: 40px;
    }

    .layer-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .layer-title::before {
      content: '';
      width: 4px;
      height: 24px;
      background: linear-gradient(180deg, var(--cyan), var(--purple));
      border-radius: 2px;
    }

    .layer-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
    }

    /* Step card */
    .step-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .step-card:hover {
      border-color: var(--accent);
      box-shadow: 0 8px 30px rgba(59, 130, 246, 0.2);
      transform: translateY(-2px);
    }

    .step-header {
      padding: 20px;
      background: var(--bg-hover);
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .step-number {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--accent);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 14px;
    }

    .step-title-text {
      flex: 1;
      margin-left: 15px;
    }

    .step-name {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .step-route {
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      color: var(--cyan);
      background: rgba(6, 182, 212, 0.1);
      padding: 4px 8px;
      border-radius: 4px;
      display: inline-block;
    }

    .step-status {
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .step-status.working {
      background: rgba(16, 185, 129, 0.2);
      color: var(--success);
    }

    .step-status.error {
      background: rgba(239, 68, 68, 0.2);
      color: var(--error);
    }

    .step-status.untested {
      background: rgba(161, 161, 170, 0.2);
      color: var(--text-dim);
    }

    .step-body {
      padding: 20px;
    }

    .section {
      margin-bottom: 20px;
    }

    .section:last-child {
      margin-bottom: 0;
    }

    .section-title {
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-dim);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Code blocks */
    .code-block {
      background: #000;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
      line-height: 1.6;
      overflow-x: auto;
      margin-bottom: 8px;
    }

    .code-line {
      margin-bottom: 4px;
    }

    .keyword {
      color: #c678dd;
      font-weight: 600;
    }

    .string {
      color: #98c379;
    }

    .number {
      color: #d19a66;
    }

    .operator {
      color: #56b6c2;
    }

    .comment {
      color: #5c6370;
      font-style: italic;
    }

    /* Lists */
    .param-list, .validation-list, .service-list, .error-list {
      list-style: none;
    }

    .param-item, .validation-item, .service-item, .error-item {
      padding: 10px;
      background: var(--bg-hover);
      border-left: 3px solid var(--accent);
      border-radius: 6px;
      margin-bottom: 8px;
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }

    .param-item {
      border-left-color: var(--cyan);
    }

    .validation-item {
      border-left-color: var(--warning);
    }

    .service-item {
      border-left-color: var(--purple);
    }

    .error-item {
      border-left-color: var(--error);
    }

    .item-icon {
      flex-shrink: 0;
      font-size: 14px;
    }

    .item-content {
      flex: 1;
    }

    .item-label {
      font-weight: 600;
      font-size: 13px;
      margin-bottom: 4px;
    }

    .item-type {
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      color: var(--text-dim);
      background: rgba(255, 255, 255, 0.05);
      padding: 2px 6px;
      border-radius: 3px;
      display: inline-block;
    }

    .item-desc {
      font-size: 12px;
      color: var(--text-dim);
      margin-top: 4px;
    }

    /* Flow arrows */
    .flow-arrow {
      text-align: center;
      font-size: 24px;
      color: var(--accent);
      margin: 20px 0;
    }

    /* Performance metrics */
    .metrics {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 12px;
    }

    .metric {
      background: var(--bg-hover);
      padding: 12px;
      border-radius: 6px;
      text-align: center;
    }

    .metric-value {
      font-size: 20px;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 4px;
    }

    .metric-label {
      font-size: 11px;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* External services */
    .external-services {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 12px;
    }

    .service-badge {
      padding: 8px 12px;
      background: var(--bg-hover);
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .service-badge.active {
      border-color: var(--success);
      background: rgba(16, 185, 129, 0.1);
    }

    /* Data flow diagram */
    .flow-diagram {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 40px;
    }

    .flow-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 30px;
      text-align: center;
    }

    .flow-row {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
    }

    .flow-box {
      flex: 1;
      padding: 20px;
      background: var(--bg-hover);
      border: 2px solid var(--border);
      border-radius: 8px;
      text-align: center;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .flow-box:hover {
      border-color: var(--accent);
      transform: scale(1.05);
    }

    .flow-box.frontend {
      border-color: var(--cyan);
    }

    .flow-box.backend {
      border-color: var(--purple);
    }

    .flow-box.external {
      border-color: var(--warning);
    }

    .flow-connector {
      font-size: 24px;
      color: var(--accent);
    }

    /* Database schema */
    .db-schema {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .db-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 15px;
      color: var(--cyan);
    }

    .db-fields {
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
    }

    .db-field {
      padding: 8px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
    }

    .db-field:last-child {
      border-bottom: none;
    }

    .field-name {
      color: var(--text);
      font-weight: 600;
    }

    .field-type {
      color: var(--text-dim);
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--accent);
    }

    .legend {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
    }

    .legend-color {
      width: 16px;
      height: 16px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üèóÔ∏è SAR - Plan d'Architecture Technique</h1>
      <p>Syst√®me de Demande de Pr√™t - Architecture Compl√®te & D√©taill√©e</p>
    </div>

    <div class="legend">
      <div class="legend-item">
        <div class="legend-color" style="background: var(--success);"></div>
        <span>Fonctionnel (test√©)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: var(--error);"></div>
        <span>Erreurs d√©tect√©es</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: var(--text-dim);"></div>
        <span>Non test√©</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: var(--cyan);"></div>
        <span>Frontend</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: var(--purple);"></div>
        <span>Backend API</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: var(--warning);"></div>
        <span>Service Externe</span>
      </div>
    </div>

    <!-- Flow Diagram -->
    <div class="flow-diagram">
      <div class="flow-title">üìä Flux de Donn√©es Global</div>
      <div class="flow-row">
        <div class="flow-box frontend">üåê Frontend<br><small>Next.js + React</small></div>
        <div class="flow-connector">‚Üí</div>
        <div class="flow-box backend">‚öôÔ∏è Backend API<br><small>Next.js API Routes</small></div>
        <div class="flow-connector">‚Üí</div>
        <div class="flow-box external">üì° Services Externes<br><small>Flinks, VoPay, Equifax</small></div>
      </div>
      <div class="flow-row">
        <div class="flow-box backend">üóÑÔ∏è Database<br><small>Supabase PostgreSQL</small></div>
        <div class="flow-connector">‚Üê</div>
        <div class="flow-box backend">üß† AI/ML<br><small>Sentinel Scoring</small></div>
        <div class="flow-connector">‚Üê</div>
        <div class="flow-box backend">üìä Analytics<br><small>Performance Tracking</small></div>
      </div>
    </div>

    <!-- Layer 1: Frontend -->
    <div class="layer">
      <div class="layer-title">üåê Couche 1: Frontend (Client-Side)</div>
      <div class="layer-grid">
        <div class="step-card">
          <div class="step-header">
            <div class="step-number">1</div>
            <div class="step-title-text">
              <div class="step-name">Landing Page</div>
              <div class="step-route">/</div>
            </div>
            <div class="step-status working">Actif</div>
          </div>
          <div class="step-body">
            <div class="section">
              <div class="section-title">üìù Composants</div>
              <ul class="param-list">
                <li class="param-item">
                  <span class="item-icon">üé®</span>
                  <div class="item-content">
                    <div class="item-label">Hero Section</div>
                    <div class="item-desc">Titre, CTA "Faire une demande"</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üí∞</span>
                  <div class="item-content">
                    <div class="item-label">Calculator Widget</div>
                    <div class="item-desc">Montant: 100$ - 1500$, Dur√©e: 14-30 jours</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">‚ú®</span>
                  <div class="item-content">
                    <div class="item-label">Trust Indicators</div>
                    <div class="item-desc">Badges s√©curit√©, avis clients</div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">üîÑ √âtat Initial</div>
              <div class="code-block">
                <div class="code-line"><span class="keyword">const</span> [amount, setAmount] = <span class="keyword">useState</span>(<span class="number">500</span>)</div>
                <div class="code-line"><span class="keyword">const</span> [duration, setDuration] = <span class="keyword">useState</span>(<span class="number">14</span>)</div>
                <div class="code-line"><span class="keyword">const</span> [loading, setLoading] = <span class="keyword">useState</span>(<span class="keyword">false</span>)</div>
              </div>
            </div>
          </div>
        </div>

        <div class="step-card">
          <div class="step-header">
            <div class="step-number">2</div>
            <div class="step-title-text">
              <div class="step-name">Formulaire de Demande</div>
              <div class="step-route">/application</div>
            </div>
            <div class="step-status working">Actif</div>
          </div>
          <div class="step-body">
            <div class="section">
              <div class="section-title">üìã Champs Requis</div>
              <ul class="param-list">
                <li class="param-item">
                  <span class="item-icon">üë§</span>
                  <div class="item-content">
                    <div class="item-label">Nom complet <span class="item-type">string</span></div>
                    <div class="item-desc">Min 2 mots, max 100 chars</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üìß</span>
                  <div class="item-content">
                    <div class="item-label">Email <span class="item-type">email</span></div>
                    <div class="item-desc">Format valide requis</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üì±</span>
                  <div class="item-content">
                    <div class="item-label">T√©l√©phone <span class="item-type">string</span></div>
                    <div class="item-desc">Format: (XXX) XXX-XXXX</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üí∞</span>
                  <div class="item-content">
                    <div class="item-label">Montant <span class="item-type">number</span></div>
                    <div class="item-desc">Range: 100 - 1500</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üè†</span>
                  <div class="item-content">
                    <div class="item-label">Adresse compl√®te <span class="item-type">object</span></div>
                    <div class="item-desc">rue, ville, province, code postal</div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">‚úÖ Validations Client-Side</div>
              <div class="code-block">
                <div class="code-line"><span class="keyword">if</span> (<span class="operator">!</span>email.<span class="keyword">match</span>(<span class="string">/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/</span>)) {</div>
                <div class="code-line">  <span class="keyword">return</span> <span class="string">"Email invalide"</span></div>
                <div class="code-line">}</div>
                <div class="code-line"></div>
                <div class="code-line"><span class="keyword">if</span> (amount <span class="operator">&lt;</span> <span class="number">100</span> <span class="operator">||</span> amount <span class="operator">&gt;</span> <span class="number">1500</span>) {</div>
                <div class="code-line">  <span class="keyword">return</span> <span class="string">"Montant hors limites"</span></div>
                <div class="code-line">}</div>
                <div class="code-line"></div>
                <div class="code-line"><span class="keyword">if</span> (<span class="operator">!</span>phone.<span class="keyword">match</span>(<span class="string">/^\d{10}$/</span>)) {</div>
                <div class="code-line">  <span class="keyword">return</span> <span class="string">"T√©l√©phone invalide (10 chiffres)"</span></div>
                <div class="code-line">}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Layer 2: Backend API Routes -->
    <div class="layer">
      <div class="layer-title">‚öôÔ∏è Couche 2: Backend API Routes</div>
      <div class="layer-grid">
        <div class="step-card">
          <div class="step-header">
            <div class="step-number">3</div>
            <div class="step-title-text">
              <div class="step-name">Soumission Application</div>
              <div class="step-route">POST /api/applications/submit</div>
            </div>
            <div class="step-status untested">Non test√©</div>
          </div>
          <div class="step-body">
            <div class="section">
              <div class="section-title">üì• Request Body</div>
              <div class="code-block">
                <div class="code-line">{</div>
                <div class="code-line">  <span class="string">"name"</span>: <span class="string">"Jean Tremblay"</span>,</div>
                <div class="code-line">  <span class="string">"email"</span>: <span class="string">"jean@example.com"</span>,</div>
                <div class="code-line">  <span class="string">"phone"</span>: <span class="string">"5141234567"</span>,</div>
                <div class="code-line">  <span class="string">"amount"</span>: <span class="number">500</span>,</div>
                <div class="code-line">  <span class="string">"duration"</span>: <span class="number">14</span>,</div>
                <div class="code-line">  <span class="string">"address"</span>: {</div>
                <div class="code-line">    <span class="string">"street"</span>: <span class="string">"123 rue Principale"</span>,</div>
                <div class="code-line">    <span class="string">"city"</span>: <span class="string">"Montr√©al"</span>,</div>
                <div class="code-line">    <span class="string">"province"</span>: <span class="string">"QC"</span>,</div>
                <div class="code-line">    <span class="string">"postal_code"</span>: <span class="string">"H1A 1A1"</span></div>
                <div class="code-line">  }</div>
                <div class="code-line">}</div>
              </div>
            </div>

            <div class="section">
              <div class="section-title">üîç Validations Backend</div>
              <ul class="validation-list">
                <li class="validation-item">
                  <span class="item-icon">1Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Rate Limiting</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">if</span> (requests_per_ip <span class="operator">&gt;</span> <span class="number">5</span>) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Trop de requ√™tes"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">2Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Duplicate Check</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">const</span> existing = <span class="keyword">await</span> db.applications</div>
                      <div class="code-line">  .<span class="keyword">where</span>({ email, created_at: <span class="string">'last 24h'</span> })</div>
                      <div class="code-line"></div>
                      <div class="code-line"><span class="keyword">if</span> (existing) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Demande d√©j√† soumise"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">3Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Data Sanitization</div>
                    <div class="code-block">
                      <div class="code-line">name = sanitize(name).<span class="keyword">trim</span>()</div>
                      <div class="code-line">email = email.<span class="keyword">toLowerCase</span>().<span class="keyword">trim</span>()</div>
                      <div class="code-line">phone = phone.<span class="keyword">replace</span>(<span class="string">/\D/g</span>, <span class="string">''</span>)</div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">üíæ Insertion Database</div>
              <div class="code-block">
                <div class="code-line"><span class="keyword">const</span> application = <span class="keyword">await</span> supabase</div>
                <div class="code-line">  .<span class="keyword">from</span>(<span class="string">'loan_applications'</span>)</div>
                <div class="code-line">  .<span class="keyword">insert</span>({</div>
                <div class="code-line">    name, email, phone, amount, duration,</div>
                <div class="code-line">    address_json: address,</div>
                <div class="code-line">    status: <span class="string">'pending'</span>,</div>
                <div class="code-line">    created_at: <span class="keyword">new</span> Date(),</div>
                <div class="code-line">    ip_address: request.ip,</div>
                <div class="code-line">    user_agent: request.headers[<span class="string">'user-agent'</span>]</div>
                <div class="code-line">  })</div>
                <div class="code-line">  .<span class="keyword">select</span>()</div>
              </div>
            </div>

            <div class="section">
              <div class="section-title">‚ùå Erreurs Possibles</div>
              <ul class="error-list">
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Validation Failed</div>
                    <div class="item-desc">Champs manquants ou invalides</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">409 - Duplicate Application</div>
                    <div class="item-desc">Demande d√©j√† soumise dans les 24h</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">429 - Rate Limit Exceeded</div>
                    <div class="item-desc">Trop de requ√™tes de cette IP</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">500 - Database Error</div>
                    <div class="item-desc">Erreur Supabase lors de l'insertion</div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="metrics">
              <div class="metric">
                <div class="metric-value">--</div>
                <div class="metric-label">Temps Moyen</div>
              </div>
              <div class="metric">
                <div class="metric-value">0</div>
                <div class="metric-label">Requ√™tes</div>
              </div>
              <div class="metric">
                <div class="metric-value">--</div>
                <div class="metric-label">Taux Erreur</div>
              </div>
            </div>
          </div>
        </div>

        <div class="step-card">
          <div class="step-header">
            <div class="step-number">4</div>
            <div class="step-title-text">
              <div class="step-name">V√©rification Identit√©</div>
              <div class="step-route">POST /api/device/deep-inspector</div>
            </div>
            <div class="step-status untested">Non test√©</div>
          </div>
          <div class="step-body">
            <div class="section">
              <div class="section-title">üì• Documents Requis</div>
              <ul class="param-list">
                <li class="param-item">
                  <span class="item-icon">üÜî</span>
                  <div class="item-content">
                    <div class="item-label">Photo ID <span class="item-type">file (image)</span></div>
                    <div class="item-desc">Permis de conduire ou carte d'identit√©</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">ü§≥</span>
                  <div class="item-content">
                    <div class="item-label">Selfie <span class="item-type">file (image)</span></div>
                    <div class="item-desc">Photo du client avec ID</div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">üîç Validations OCR</div>
              <ul class="validation-list">
                <li class="validation-item">
                  <span class="item-icon">1Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Qualit√© Image</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">if</span> (image.width <span class="operator">&lt;</span> <span class="number">600</span> <span class="operator">||</span> image.quality <span class="operator">&lt;</span> <span class="number">0.7</span>) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Image trop floue"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">2Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Extraction Texte OCR</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">const</span> extracted = <span class="keyword">await</span> ocr.extract(photo_id)</div>
                      <div class="code-line"></div>
                      <div class="code-line"><span class="comment">// Extraire nom, date naissance, num√©ro</span></div>
                      <div class="code-line"><span class="keyword">const</span> name = extractName(extracted.text)</div>
                      <div class="code-line"><span class="keyword">const</span> dob = extractDate(extracted.text)</div>
                      <div class="code-line"><span class="keyword">const</span> id_number = extractID(extracted.text)</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">3Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Matching Donn√©es</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">if</span> (<span class="operator">!</span>nameMatch(extracted.name, application.name)) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Nom ne correspond pas"</span>)</div>
                      <div class="code-line">}</div>
                      <div class="code-line"></div>
                      <div class="code-line"><span class="keyword">if</span> (age <span class="operator">&lt;</span> <span class="number">18</span>) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Client mineur"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">4Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Face Matching</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">const</span> similarity = <span class="keyword">await</span> faceAPI.compare(</div>
                      <div class="code-line">  photo_id_face,</div>
                      <div class="code-line">  selfie_face</div>
                      <div class="code-line">)</div>
                      <div class="code-line"></div>
                      <div class="code-line"><span class="keyword">if</span> (similarity <span class="operator">&lt;</span> <span class="number">0.85</span>) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Visages ne correspondent pas"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">üîÑ Services Externes</div>
              <div class="external-services">
                <div class="service-badge">
                  <span>üì∑</span> Tesseract OCR
                </div>
                <div class="service-badge">
                  <span>üß†</span> Face-API.js
                </div>
                <div class="service-badge">
                  <span>‚òÅÔ∏è</span> AWS S3 (stockage)
                </div>
              </div>
            </div>

            <div class="section">
              <div class="section-title">‚ùå Erreurs Possibles</div>
              <ul class="error-list">
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Image Floue</div>
                    <div class="item-desc">Qualit√© insuffisante ou r√©solution trop basse</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - OCR Failed</div>
                    <div class="item-desc">Impossible d'extraire le texte du document</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Name Mismatch</div>
                    <div class="item-desc">Nom sur ID ‚â† nom application</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Face Mismatch</div>
                    <div class="item-desc">Selfie ne correspond pas √† la photo ID</div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="step-card">
          <div class="step-header">
            <div class="step-number">5</div>
            <div class="step-title-text">
              <div class="step-name">V√©rification Cr√©dit</div>
              <div class="step-route">POST /api/osint/scan</div>
            </div>
            <div class="step-status untested">Non test√©</div>
          </div>
          <div class="step-body">
            <div class="section">
              <div class="section-title">üì• Donn√©es Requises</div>
              <ul class="param-list">
                <li class="param-item">
                  <span class="item-icon">üî¢</span>
                  <div class="item-content">
                    <div class="item-label">SIN <span class="item-type">string</span></div>
                    <div class="item-desc">Num√©ro d'assurance sociale (9 chiffres)</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üìÖ</span>
                  <div class="item-content">
                    <div class="item-label">Date de naissance <span class="item-type">date</span></div>
                    <div class="item-desc">Format: YYYY-MM-DD</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üè†</span>
                  <div class="item-content">
                    <div class="item-label">Adresse compl√®te <span class="item-type">object</span></div>
                    <div class="item-desc">Pour matching bureau cr√©dit</div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">üîç Appel Bureau de Cr√©dit</div>
              <div class="code-block">
                <div class="code-line"><span class="comment">// Call Equifax API</span></div>
                <div class="code-line"><span class="keyword">const</span> creditReport = <span class="keyword">await</span> equifax.getCreditReport({</div>
                <div class="code-line">  sin: encrypted_sin,</div>
                <div class="code-line">  firstName: client.first_name,</div>
                <div class="code-line">  lastName: client.last_name,</div>
                <div class="code-line">  dateOfBirth: client.dob,</div>
                <div class="code-line">  address: client.address</div>
                <div class="code-line">})</div>
              </div>
            </div>

            <div class="section">
              <div class="section-title">‚úÖ Analyse Score</div>
              <ul class="validation-list">
                <li class="validation-item">
                  <span class="item-icon">1Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Score Minimum</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">if</span> (creditReport.score <span class="operator">&lt;</span> <span class="number">550</span>) {</div>
                      <div class="code-line">  status = <span class="string">'rejected'</span></div>
                      <div class="code-line">  reason = <span class="string">'Score cr√©dit trop bas'</span></div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">2Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Faillite R√©cente</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">const</span> bankruptcy = creditReport.publicRecords</div>
                      <div class="code-line">  .<span class="keyword">filter</span>(r <span class="operator">=&gt;</span> r.type === <span class="string">'bankruptcy'</span>)</div>
                      <div class="code-line"></div>
                      <div class="code-line"><span class="keyword">if</span> (bankruptcy.length <span class="operator">&gt;</span> <span class="number">0</span>) {</div>
                      <div class="code-line">  <span class="keyword">const</span> yearsAgo = getYearsSince(bankruptcy[<span class="number">0</span>].date)</div>
                      <div class="code-line">  <span class="keyword">if</span> (yearsAgo <span class="operator">&lt;</span> <span class="number">3</span>) {</div>
                      <div class="code-line">    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Faillite r√©cente"</span>)</div>
                      <div class="code-line">  }</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">3Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Retards de Paiement</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">const</span> latePayments = creditReport.tradelines</div>
                      <div class="code-line">  .<span class="keyword">filter</span>(t <span class="operator">=&gt;</span> t.payment_status === <span class="string">'late'</span>)</div>
                      <div class="code-line"></div>
                      <div class="code-line"><span class="keyword">if</span> (latePayments.length <span class="operator">&gt;</span> <span class="number">3</span>) {</div>
                      <div class="code-line">  riskScore <span class="operator">+=</span> <span class="number">20</span></div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">üîÑ Services Externes</div>
              <div class="external-services">
                <div class="service-badge">
                  <span>üìä</span> Equifax Canada
                </div>
                <div class="service-badge">
                  <span>üîê</span> Encryption Service
                </div>
              </div>
            </div>

            <div class="section">
              <div class="section-title">‚ùå Erreurs Possibles</div>
              <ul class="error-list">
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Invalid SIN</div>
                    <div class="item-desc">SIN invalide ou format incorrect</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Score Too Low</div>
                    <div class="item-desc">Score cr√©dit &lt; 550</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Recent Bankruptcy</div>
                    <div class="item-desc">Faillite dans les 3 derni√®res ann√©es</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">503 - Equifax Unavailable</div>
                    <div class="item-desc">Service Equifax temporairement indisponible</div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="step-card">
          <div class="step-header">
            <div class="step-number">6</div>
            <div class="step-title-text">
              <div class="step-name">Scoring AI</div>
              <div class="step-route">POST /api/sentinel/scoring</div>
            </div>
            <div class="step-status untested">Non test√©</div>
          </div>
          <div class="step-body">
            <div class="section">
              <div class="section-title">üì• Inputs ML Model</div>
              <ul class="param-list">
                <li class="param-item">
                  <span class="item-icon">üìä</span>
                  <div class="item-content">
                    <div class="item-label">credit_score <span class="item-type">number</span></div>
                    <div class="item-desc">Score Equifax (300-900)</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üí∞</span>
                  <div class="item-content">
                    <div class="item-label">monthly_income <span class="item-type">number</span></div>
                    <div class="item-desc">Revenus mensuels bruts</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üí∏</span>
                  <div class="item-content">
                    <div class="item-label">monthly_expenses <span class="item-type">number</span></div>
                    <div class="item-desc">D√©penses mensuelles d√©clar√©es</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üè¶</span>
                  <div class="item-content">
                    <div class="item-label">existing_debt <span class="item-type">number</span></div>
                    <div class="item-desc">Dette totale actuelle</div>
                  </div>
                </li>
                <li class="param-item">
                  <span class="item-icon">üìÖ</span>
                  <div class="item-content">
                    <div class="item-label">employment_months <span class="item-type">number</span></div>
                    <div class="item-desc">Anciennet√© emploi actuel</div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">üß† Calculs ML</div>
              <div class="code-block">
                <div class="code-line"><span class="comment">// 1. Ratio d'endettement</span></div>
                <div class="code-line"><span class="keyword">const</span> debtRatio = (existing_debt <span class="operator">+</span> amount) <span class="operator">/</span> monthly_income</div>
                <div class="code-line"></div>
                <div class="code-line"><span class="keyword">if</span> (debtRatio <span class="operator">&gt;</span> <span class="number">0.40</span>) {</div>
                <div class="code-line">  score <span class="operator">-=</span> <span class="number">30</span></div>
                <div class="code-line">  risk_factors.<span class="keyword">push</span>(<span class="string">"Ratio endettement &gt; 40%"</span>)</div>
                <div class="code-line">}</div>
                <div class="code-line"></div>
                <div class="code-line"><span class="comment">// 2. Capacit√© de remboursement</span></div>
                <div class="code-line"><span class="keyword">const</span> disposableIncome = monthly_income <span class="operator">-</span> monthly_expenses</div>
                <div class="code-line"><span class="keyword">const</span> monthlyPayment = calculatePayment(amount, duration)</div>
                <div class="code-line"></div>
                <div class="code-line"><span class="keyword">if</span> (disposableIncome <span class="operator">&lt;</span> monthlyPayment <span class="operator">*</span> <span class="number">1.5</span>) {</div>
                <div class="code-line">  score <span class="operator">-=</span> <span class="number">25</span></div>
                <div class="code-line">  risk_factors.<span class="keyword">push</span>(<span class="string">"Revenus insuffisants"</span>)</div>
                <div class="code-line">}</div>
                <div class="code-line"></div>
                <div class="code-line"><span class="comment">// 3. Score cr√©dit normalis√©</span></div>
                <div class="code-line"><span class="keyword">const</span> creditScoreNorm = (credit_score <span class="operator">-</span> <span class="number">300</span>) <span class="operator">/</span> <span class="number">600</span></div>
                <div class="code-line">score <span class="operator">+=</span> creditScoreNorm <span class="operator">*</span> <span class="number">40</span></div>
                <div class="code-line"></div>
                <div class="code-line"><span class="comment">// 4. Stabilit√© emploi</span></div>
                <div class="code-line"><span class="keyword">if</span> (employment_months <span class="operator">&gt;</span> <span class="number">12</span>) {</div>
                <div class="code-line">  score <span class="operator">+=</span> <span class="number">10</span></div>
                <div class="code-line">} <span class="keyword">else if</span> (employment_months <span class="operator">&lt;</span> <span class="number">3</span>) {</div>
                <div class="code-line">  score <span class="operator">-=</span> <span class="number">15</span></div>
                <div class="code-line">}</div>
                <div class="code-line"></div>
                <div class="code-line"><span class="comment">// Score final: 0-100</span></div>
                <div class="code-line"><span class="keyword">const</span> finalScore = Math.<span class="keyword">max</span>(<span class="number">0</span>, Math.<span class="keyword">min</span>(<span class="number">100</span>, score))</div>
              </div>
            </div>

            <div class="section">
              <div class="section-title">‚úÖ D√©cision Automatique</div>
              <ul class="validation-list">
                <li class="validation-item">
                  <span class="item-icon">‚úÖ</span>
                  <div class="item-content">
                    <div class="item-label">Approbation Auto</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">if</span> (finalScore <span class="operator">&gt;=</span> <span class="number">70</span>) {</div>
                      <div class="code-line">  decision = <span class="string">'approved'</span></div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">‚ö†Ô∏è</span>
                  <div class="item-content">
                    <div class="item-label">R√©vision Manuelle</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">else if</span> (finalScore <span class="operator">&gt;=</span> <span class="number">50</span> <span class="operator">&amp;&amp;</span> finalScore <span class="operator">&lt;</span> <span class="number">70</span>) {</div>
                      <div class="code-line">  decision = <span class="string">'manual_review'</span></div>
                      <div class="code-line">  <span class="comment">// Envoyer √† un agent</span></div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">‚ùå</span>
                  <div class="item-content">
                    <div class="item-label">Refus Auto</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">else</span> {</div>
                      <div class="code-line">  decision = <span class="string">'rejected'</span></div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">‚ùå Erreurs Possibles</div>
              <ul class="error-list">
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Missing Data</div>
                    <div class="item-desc">Donn√©es financi√®res incompl√®tes</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - High Debt Ratio</div>
                    <div class="item-desc">Ratio endettement &gt; 40%</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">500 - Model Timeout</div>
                    <div class="item-desc">Mod√®le ML timeout ou erreur calcul</div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="step-card">
          <div class="step-header">
            <div class="step-number">7</div>
            <div class="step-title-text">
              <div class="step-name">Liaison Bancaire</div>
              <div class="step-route">POST /api/admin/vopay/transactions</div>
            </div>
            <div class="step-status working">23ms avg</div>
          </div>
          <div class="step-body">
            <div class="section">
              <div class="section-title">üîó Connexion Flinks</div>
              <div class="code-block">
                <div class="code-line"><span class="comment">// 1. G√©n√©rer Flinks Connect URL</span></div>
                <div class="code-line"><span class="keyword">const</span> flinksUrl = <span class="keyword">await</span> flinks.generateConnectUrl({</div>
                <div class="code-line">  clientId: application.id,</div>
                <div class="code-line">  redirectUrl: <span class="string">'/api/flinks/callback'</span>,</div>
                <div class="code-line">  institution: selectedBank</div>
                <div class="code-line">})</div>
                <div class="code-line"></div>
                <div class="code-line"><span class="comment">// 2. Client connecte son compte</span></div>
                <div class="code-line"><span class="comment">// Flinks widget popup</span></div>
                <div class="code-line"></div>
                <div class="code-line"><span class="comment">// 3. Callback re√ßu avec loginId</span></div>
                <div class="code-line"><span class="keyword">const</span> accountDetails = <span class="keyword">await</span> flinks.getAccountDetails(loginId)</div>
              </div>
            </div>

            <div class="section">
              <div class="section-title">‚úÖ Validations Bancaires</div>
              <ul class="validation-list">
                <li class="validation-item">
                  <span class="item-icon">1Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Compte Actif</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">if</span> (account.status <span class="operator">!==</span> <span class="string">'active'</span>) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Compte ferm√© ou inactif"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">2Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Type Compte</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">if</span> (account.type <span class="operator">!==</span> <span class="string">'checking'</span>) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Doit √™tre compte ch√®que"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">3Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Titulaire</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">const</span> holderMatch = nameMatch(</div>
                      <div class="code-line">  account.holder_name,</div>
                      <div class="code-line">  application.name</div>
                      <div class="code-line">)</div>
                      <div class="code-line"></div>
                      <div class="code-line"><span class="keyword">if</span> (<span class="operator">!</span>holderMatch) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Nom titulaire diff√©rent"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">üíæ Enregistrement VoPay</div>
              <div class="code-block">
                <div class="code-line"><span class="comment">// Cr√©er profil VoPay</span></div>
                <div class="code-line"><span class="keyword">const</span> vopayProfile = <span class="keyword">await</span> vopay.createProfile({</div>
                <div class="code-line">  firstName: client.first_name,</div>
                <div class="code-line">  lastName: client.last_name,</div>
                <div class="code-line">  email: client.email,</div>
                <div class="code-line">  bankAccount: {</div>
                <div class="code-line">    institution: account.institution_number,</div>
                <div class="code-line">    transit: account.transit_number,</div>
                <div class="code-line">    account: account.account_number</div>
                <div class="code-line">  }</div>
                <div class="code-line">})</div>
              </div>
            </div>

            <div class="section">
              <div class="section-title">üîÑ Services Externes</div>
              <div class="external-services">
                <div class="service-badge active">
                  <span>üè¶</span> Flinks
                </div>
                <div class="service-badge active">
                  <span>üí≥</span> VoPay
                </div>
              </div>
            </div>

            <div class="metrics">
              <div class="metric">
                <div class="metric-value">83ms</div>
                <div class="metric-label">Temps Moyen</div>
              </div>
              <div class="metric">
                <div class="metric-value">2</div>
                <div class="metric-label">Requ√™tes</div>
              </div>
              <div class="metric">
                <div class="metric-value">0%</div>
                <div class="metric-label">Erreurs</div>
              </div>
            </div>
          </div>
        </div>

        <div class="step-card">
          <div class="step-header">
            <div class="step-number">8</div>
            <div class="step-title-text">
              <div class="step-name">D√©caissement</div>
              <div class="step-route">POST /api/admin/vopay/transactions</div>
            </div>
            <div class="step-status working">83ms avg</div>
          </div>
          <div class="step-body">
            <div class="section">
              <div class="section-title">üí∏ Initier Virement</div>
              <div class="code-block">
                <div class="code-line"><span class="keyword">const</span> transaction = <span class="keyword">await</span> vopay.initiateEFT({</div>
                <div class="code-line">  profileId: vopayProfile.id,</div>
                <div class="code-line">  amount: loanAmount,</div>
                <div class="code-line">  currency: <span class="string">'CAD'</span>,</div>
                <div class="code-line">  reference: <span class="string">`SAR-LP-${application.id}`</span>,</div>
                <div class="code-line">  description: <span class="string">'Pr√™t SAR'</span></div>
                <div class="code-line">})</div>
              </div>
            </div>

            <div class="section">
              <div class="section-title">‚úÖ V√©rifications Finales</div>
              <ul class="validation-list">
                <li class="validation-item">
                  <span class="item-icon">1Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Limite Quotidienne</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">const</span> todayTotal = <span class="keyword">await</span> getTotalDisbursedToday()</div>
                      <div class="code-line"></div>
                      <div class="code-line"><span class="keyword">if</span> (todayTotal <span class="operator">+</span> amount <span class="operator">&gt;</span> DAILY_LIMIT) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Limite quotidienne atteinte"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">2Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Documents Sign√©s</div>
                    <div class="code-block">
                      <div class="code-line"><span class="keyword">if</span> (<span class="operator">!</span>application.contract_signed) {</div>
                      <div class="code-line">  <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Contrat non sign√©"</span>)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
                <li class="validation-item">
                  <span class="item-icon">3Ô∏è‚É£</span>
                  <div class="item-content">
                    <div class="item-label">Statut VoPay</div>
                    <div class="code-block">
                      <div class="code-line"><span class="comment">// Poll transaction status</span></div>
                      <div class="code-line"><span class="keyword">const</span> status = <span class="keyword">await</span> vopay.getTransactionStatus(</div>
                      <div class="code-line">  transaction.id</div>
                      <div class="code-line">)</div>
                      <div class="code-line"></div>
                      <div class="code-line"><span class="keyword">if</span> (status === <span class="string">'completed'</span>) {</div>
                      <div class="code-line">  <span class="comment">// Notifier client</span></div>
                      <div class="code-line">  <span class="keyword">await</span> sendConfirmationEmail(client)</div>
                      <div class="code-line">}</div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="section">
              <div class="section-title">‚ùå Erreurs Possibles</div>
              <ul class="error-list">
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Daily Limit</div>
                    <div class="item-desc">Limite quotidienne de d√©caissement atteinte</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">400 - Account Blocked</div>
                    <div class="item-desc">Compte bancaire client bloqu√©</div>
                  </div>
                </li>
                <li class="error-item">
                  <span class="item-icon">üö´</span>
                  <div class="item-content">
                    <div class="item-label">503 - VoPay Timeout</div>
                    <div class="item-desc">VoPay ne r√©pond pas (r√©essayer)</div>
                  </div>
                </li>
              </ul>
            </div>

            <div class="metrics">
              <div class="metric">
                <div class="metric-value">83ms</div>
                <div class="metric-label">Temps Moyen</div>
              </div>
              <div class="metric">
                <div class="metric-value">2</div>
                <div class="metric-label">Requ√™tes</div>
              </div>
              <div class="metric">
                <div class="metric-value">0%</div>
                <div class="metric-label">Erreurs</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Database Schema -->
    <div class="layer">
      <div class="layer-title">üóÑÔ∏è Sch√©ma Database</div>
      <div class="layer-grid">
        <div class="db-schema">
          <div class="db-title">Table: loan_applications</div>
          <div class="db-fields">
            <div class="db-field">
              <span class="field-name">id</span>
              <span class="field-type">uuid PRIMARY KEY</span>
            </div>
            <div class="db-field">
              <span class="field-name">name</span>
              <span class="field-type">text NOT NULL</span>
            </div>
            <div class="db-field">
              <span class="field-name">email</span>
              <span class="field-type">text NOT NULL</span>
            </div>
            <div class="db-field">
              <span class="field-name">phone</span>
              <span class="field-type">text NOT NULL</span>
            </div>
            <div class="db-field">
              <span class="field-name">amount</span>
              <span class="field-type">numeric NOT NULL</span>
            </div>
            <div class="db-field">
              <span class="field-name">duration_days</span>
              <span class="field-type">integer NOT NULL</span>
            </div>
            <div class="db-field">
              <span class="field-name">status</span>
              <span class="field-type">text (pending/approved/rejected)</span>
            </div>
            <div class="db-field">
              <span class="field-name">credit_score</span>
              <span class="field-type">integer</span>
            </div>
            <div class="db-field">
              <span class="field-name">ml_score</span>
              <span class="field-type">numeric</span>
            </div>
            <div class="db-field">
              <span class="field-name">vopay_profile_id</span>
              <span class="field-type">text</span>
            </div>
            <div class="db-field">
              <span class="field-name">created_at</span>
              <span class="field-type">timestamptz</span>
            </div>
          </div>
        </div>

        <div class="db-schema">
          <div class="db-title">Table: vopay_transactions</div>
          <div class="db-fields">
            <div class="db-field">
              <span class="field-name">id</span>
              <span class="field-type">uuid PRIMARY KEY</span>
            </div>
            <div class="db-field">
              <span class="field-name">application_id</span>
              <span class="field-type">uuid REFERENCES applications</span>
            </div>
            <div class="db-field">
              <span class="field-name">vopay_transaction_id</span>
              <span class="field-type">text UNIQUE</span>
            </div>
            <div class="db-field">
              <span class="field-name">amount</span>
              <span class="field-type">numeric NOT NULL</span>
            </div>
            <div class="db-field">
              <span class="field-name">status</span>
              <span class="field-type">text (pending/completed/failed)</span>
            </div>
            <div class="db-field">
              <span class="field-name">created_at</span>
              <span class="field-type">timestamptz</span>
            </div>
            <div class="db-field">
              <span class="field-name">completed_at</span>
              <span class="field-type">timestamptz</span>
            </div>
          </div>
        </div>

        <div class="db-schema">
          <div class="db-title">Table: identity_verifications</div>
          <div class="db-fields">
            <div class="db-field">
              <span class="field-name">id</span>
              <span class="field-type">uuid PRIMARY KEY</span>
            </div>
            <div class="db-field">
              <span class="field-name">application_id</span>
              <span class="field-type">uuid REFERENCES applications</span>
            </div>
            <div class="db-field">
              <span class="field-name">id_photo_url</span>
              <span class="field-type">text</span>
            </div>
            <div class="db-field">
              <span class="field-name">selfie_url</span>
              <span class="field-type">text</span>
            </div>
            <div class="db-field">
              <span class="field-name">extracted_name</span>
              <span class="field-type">text</span>
            </div>
            <div class="db-field">
              <span class="field-name">face_match_score</span>
              <span class="field-type">numeric</span>
            </div>
            <div class="db-field">
              <span class="field-name">verified</span>
              <span class="field-type">boolean</span>
            </div>
            <div class="db-field">
              <span class="field-name">created_at</span>
              <span class="field-type">timestamptz</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Fetch real performance data
    const SUPABASE_URL = 'https://dllyzfuqjzuhvshrlmuq.supabase.co'
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsbHl6ZnVxanp1aHZzaHJsbXVxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5OTU5ODEsImV4cCI6MjA4MTU3MTk4MX0.xskVblRlKdbTST1Mdgz76oR7N2rDq8ZOUgaN-f_TTM4'

    async function loadPerformanceMetrics() {
      try {
        const response = await fetch(`${SUPABASE_URL}/rest/v1/vw_route_performance?select=*`, {
          headers: {
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
          }
        })

        if (response.ok) {
          const data = await response.json()
          console.log('‚úÖ Performance metrics loaded:', data)

          // Update metrics in real cards based on routes
          // This would update the metric boxes with real data
        }
      } catch (error) {
        console.error('Error loading metrics:', error)
      }
    }

    loadPerformanceMetrics()
  </script>
</body>
</html>
